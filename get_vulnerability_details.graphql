
query  {
  vulnerabilitiesV32: vulnerabilitiesV3(
    filter: {
      logicalFilter: {
        operator: AND
        filters: [
          {
            logicalFilter: {
              operator: OR
              filters: [
                {
                  logicalFilter: {
                    operator: AND
                    filters: [
                      {
                        relationalFilter: {
                          key: API_IS_LEARNT
                          operator: EQUALS
                          value: true
                        }
                      }
                      {
                        relationalFilter: {
                          key: API_DISCOVERY_STATE
                          operator: IN
                          value: ["DISCOVERED", "UNDER_DISCOVERY"]
                        }
                      }
                      {
                        relationalFilter: {
                          key: SOURCES
                          operator: IN
                          value: [
                            "VULNERABILITY_SOURCE_TYPE_RUNTIME_PROTECTION"
                            "VULNERABILITY_SOURCE_TYPE_GATEWAY_CONFIGURATION"
                          ]
                        }
                      }
                    ]
                  }
                }
                {
                  relationalFilter: {
                    key: SOURCES
                    operator: IN
                    value: ["VULNERABILITY_SOURCE_TYPE_SECURITY_TESTING"]
                  }
                }
              ]
            }
          }
          {
            relationalFilter: {
              key: VULNERABILITY_SUB_CATEGORY
              operator: EQUALS
              value: "PLACEHOLDER"
            }
          }
        ]
      }
    }
    orderBy: { key: LAST_SEEN_TIMESTAMP_MILLIS, direction: DESC }
    limit: 10000
    offset: 0
  ) {
    results {
      VULNERABILITY_ID: selection(key: VULNERABILITY_ID) {
        value
        type
        __typename
      }
      API_ID: selection(key: API_ID) {
        value
        type
        __typename
      }
      VULNERABILITY_CATEGORY: selection(key: VULNERABILITY_CATEGORY) {
        value
        type
        __typename
      }
      STATUS: selection(key: STATUS) {
        value
        type
        __typename
      }
      AFFECTED_SPAN_PATH: selection(key: AFFECTED_SPAN_PATH) {
        value
        type
        __typename
      }
      TEST_IDS: selection(key: TEST_IDS) {
        value
        type
        __typename
      }
      LAST_SEEN_TIMESTAMP_MILLIS: selection(key: LAST_SEEN_TIMESTAMP_MILLIS) {
        value
        type
        __typename
      }
      CREATED_TIMESTAMP_MILLIS: selection(key: CREATED_TIMESTAMP_MILLIS) {
        value
        type
        __typename
      }
      CLOSED_TIMESTAMP_MILLIS: selection(key: CLOSED_TIMESTAMP_MILLIS) {
        value
        type
        __typename
      }
      SOURCES: selection(key: SOURCES) {
        value
        type
        __typename
      }
      LACK_OF_ENCRYPTION_EVIDENCE_FIELD_SPAN_ID: selection(
        key: LACK_OF_ENCRYPTION_EVIDENCE_FIELD_SPAN_ID
      ) {
        value
        type
        __typename
      }
      entity(type: "API") {
        id
        name: attribute(expression: { key: "name" })
        riskScore: attribute(expression: { key: "riskScore" })
        riskScoreCategory: attribute(expression: { key: "riskScoreCategory" })
        serviceId: attribute(expression: { key: "serviceId" })
        serviceName: attribute(expression: { key: "serviceName" })
        __typename
      }
      __typename
    }
    count
    total
    __typename
  }
}
